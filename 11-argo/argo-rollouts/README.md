## Blue/Green部署

蓝/绿部署是最小化部署停机时间的最简单方法之一。蓝/绿部署并非 Kubernetes 特有，甚至可用于驻留在虚拟机上的传统应用程序。

1. 一开始，应用程序的所有用户都会被路由到当前版本（显示为蓝色）。关键是所有流量都从负载平衡器通过。
2. 部署新版本（显示为绿色）。该版本不接收任何实时流量，因此所有用户仍由先前/稳定版本提供服务
3. 开发人员可以在内部测试新颜色并验证其正确性。如果正确，流量就会切换到新版本
4. 如果一切顺利，旧版本将被完全丢弃。我们又回到了初始状态（颜色的顺序并不重要）。

这种模式的主要好处是，如果新版本在任何时候出现问题，所有用户都可以（通过负载平衡器）切换回以前的版本。切换负载平衡器比重新部署新版本要快得多，从而将对现有用户的影响降到最低。

这种模式有多种变体。在某些情况下，旧版本不会被销毁，而是继续在后台运行。您还可以在线保留旧版本（可能占用空间较小），以便轻松切换到任何以前的应用程序版本。

## Canary 部署

蓝/绿部署可以最大限度地减少部署后的停机时间，但并不完美。如果您的新版本有一个隐藏的问题，在一段时间后才显现出来（即您的烟雾测试没有检测到），那么您的所有用户都会受到影响，因为流量切换是全有或全无。

一种改进的部署方法是金丝雀部署。它的功能类似于蓝/绿部署，但不是一次性将 100% 的实时流量切换到新版本，而是只移动一部分用户。